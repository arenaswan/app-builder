{"version":3,"sources":["../../src/services/sanitize.ts"],"names":["DOMPurify","setConfig","ADD_ATTR","addHook","node","target","getAttribute","toLowerCase","setAttribute","removeAttribute","sanitize"],"mappings":";;;;;;;;;;;;;AAAA;;AACA;;;;AAEAA,mBAAUC,SAAV,CAAoB;AAClBC,EAAAA,QAAQ,EAAE,CAAC,QAAD;AADQ,CAApB;;AAIAF,mBAAUG,OAAV,CAAkB,yBAAlB,EAA6C,UAASC,IAAT,EAAe;AAC1D;AACA;AACA;AAEA,MAAMC,MAAM,GAAGD,IAAI,CAACE,YAAL,CAAkB,QAAlB,CAAf;;AACA,MAAI,sBAASD,MAAT,KAAoBA,MAAM,CAACE,WAAP,OAAyB,QAAjD,EAA2D;AACzDH,IAAAA,IAAI,CAACI,YAAL,CAAkB,KAAlB,EAAyB,qBAAzB;AACD,GAFD,MAEO;AACLJ,IAAAA,IAAI,CAACK,eAAL,CAAqB,QAArB;AACD;AACF,CAXD;;eAeeT,mBAAUU,Q","sourcesContent":["import { isString } from \"lodash\";\r\nimport DOMPurify from \"dompurify\";\r\n\r\nDOMPurify.setConfig({\r\n  ADD_ATTR: [\"target\"],\r\n});\r\n\r\nDOMPurify.addHook(\"afterSanitizeAttributes\", function(node) {\r\n  // Fix elements with `target` attribute:\r\n  // - allow only `target=\"_blank\"\r\n  // - add `rel=\"noopener noreferrer\"` to prevent https://www.owasp.org/index.php/Reverse_Tabnabbing\r\n\r\n  const target = node.getAttribute(\"target\");\r\n  if (isString(target) && target.toLowerCase() === \"_blank\") {\r\n    node.setAttribute(\"rel\", \"noopener noreferrer\");\r\n  } else {\r\n    node.removeAttribute(\"target\");\r\n  }\r\n});\r\n\r\nexport { DOMPurify };\r\n\r\nexport default DOMPurify.sanitize;\r\n"],"file":"sanitize.js"}