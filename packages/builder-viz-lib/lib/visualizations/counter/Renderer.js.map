{"version":3,"sources":["../../../src/visualizations/counter/Renderer.tsx"],"names":["getCounterStyles","scale","msTransform","MozTransform","WebkitTransform","transform","getCounterScale","container","inner","firstChild","Math","min","offsetWidth","offsetHeight","Number","toFixed","Renderer","data","options","visualizationName","setScale","setContainer","unwatch","rows","showTrend","trendPositive","counterValue","counterValueTooltip","targetValue","targetValueTooltip","counterLabel","propTypes","RendererPropTypes"],"mappings":"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","sourcesContent":["import { isFinite } from \"lodash\";\r\nimport React, { useState, useEffect } from \"react\";\r\nimport cx from \"classnames\";\r\nimport resizeObserver from \"@/services/resizeObserver\";\r\nimport { RendererPropTypes } from \"@/visualizations/prop-types\";\r\n\r\nimport { getCounterData } from \"./utils\";\r\n\r\nimport \"./render.less\";\r\n\r\nfunction getCounterStyles(scale: any) {\r\n  return {\r\n    msTransform: `scale(${scale})`,\r\n    MozTransform: `scale(${scale})`,\r\n    WebkitTransform: `scale(${scale})`,\r\n    transform: `scale(${scale})`,\r\n  };\r\n}\r\n\r\nfunction getCounterScale(container: any) {\r\n  const inner = container.firstChild;\r\n  const scale = Math.min(container.offsetWidth / inner.offsetWidth, container.offsetHeight / inner.offsetHeight);\r\n  return Number(isFinite(scale) ? scale : 1).toFixed(2); // keep only two decimal places\r\n}\r\n\r\nexport default function Renderer({ data, options, visualizationName }: any) {\r\n  const [scale, setScale] = useState(\"1.00\");\r\n  const [container, setContainer] = useState(null);\r\n\r\n  useEffect(() => {\r\n    if (container) {\r\n      const unwatch = resizeObserver(container, () => {\r\n        setScale(getCounterScale(container));\r\n      });\r\n      return unwatch;\r\n    }\r\n  }, [container]);\r\n\r\n  useEffect(() => {\r\n    if (container) {\r\n      // update scaling when options or data change (new formatting, values, etc.\r\n      // may change inner container dimensions which will not be tracked by `resizeObserver`);\r\n      setScale(getCounterScale(container));\r\n    }\r\n  }, [data, options, container]);\r\n\r\n  const {\r\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'showTrend' does not exist on type '{}'.\r\n    showTrend,\r\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'trendPositive' does not exist on type '{... Remove this comment to see the full error message\r\n    trendPositive,\r\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'counterValue' does not exist on type '{}... Remove this comment to see the full error message\r\n    counterValue,\r\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'counterValueTooltip' does not exist on t... Remove this comment to see the full error message\r\n    counterValueTooltip,\r\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'targetValue' does not exist on type '{}'... Remove this comment to see the full error message\r\n    targetValue,\r\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'targetValueTooltip' does not exist on ty... Remove this comment to see the full error message\r\n    targetValueTooltip,\r\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'counterLabel' does not exist on type '{}... Remove this comment to see the full error message\r\n    counterLabel,\r\n  } = getCounterData(data.rows, options, visualizationName);\r\n  return (\r\n    <div\r\n      className={cx(\"counter-visualization-container\", {\r\n        \"trend-positive\": showTrend && trendPositive,\r\n        \"trend-negative\": showTrend && !trendPositive,\r\n      })}>\r\n      {/* @ts-expect-error ts-migrate(2322) FIXME: Type 'Dispatch<SetStateAction<null>>' is not assig... Remove this comment to see the full error message */}\r\n      <div className=\"counter-visualization-content\" ref={setContainer}>\r\n        <div style={getCounterStyles(scale)}>\r\n          <div className=\"counter-visualization-value\" title={counterValueTooltip}>\r\n            {counterValue}\r\n          </div>\r\n          {targetValue && (\r\n            <div className=\"counter-visualization-target\" title={targetValueTooltip}>\r\n              ({targetValue})\r\n            </div>\r\n          )}\r\n          <div className=\"counter-visualization-label\">{counterLabel}</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nRenderer.propTypes = RendererPropTypes;\r\n"],"file":"Renderer.js"}