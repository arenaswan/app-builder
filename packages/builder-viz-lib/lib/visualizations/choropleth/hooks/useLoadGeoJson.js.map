{"version":3,"sources":["../../../../src/visualizations/choropleth/hooks/useLoadGeoJson.ts"],"names":["cache","useLoadGeoJson","mapType","geoJson","setGeoJson","isLoading","setIsLoading","mapUrl","visualizationsSettings","undefined","cancelled","promise","get","axios","catch","then","data","release"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;;;;;;;;;;;;;;;AAEA,IAAMA,KAAK,GAAG,sCAAd;;AAEe,SAASC,cAAT,CAAwBC,OAAxB,EAAsC;AAAA,kBACrB,qBAAS,IAAT,CADqB;AAAA;AAAA,MAC5CC,OAD4C;AAAA,MACnCC,UADmC;;AAAA,mBAEjB,qBAAS,KAAT,CAFiB;AAAA;AAAA,MAE5CC,SAF4C;AAAA,MAEjCC,YAFiC;;AAInD,wBAAU,MAAM;AACd,QAAMC,MAAM,GAAG,iBAAIC,8CAAJ,oCAAuDN,OAAvD,WAAsEO,SAAtE,CAAf;;AAEA,QAAI,sBAASF,MAAT,CAAJ,EAAsB;AACpBD,MAAAA,YAAY,CAAC,IAAD,CAAZ;AACA,UAAII,SAAS,GAAG,KAAhB;AAEA,UAAMC,OAAO,GAAGX,KAAK,CAACY,GAAN,CAAUL,MAAV,EAAkB,MAAMM,eAAMD,GAAN,CAAUL,MAAV,EAAkBO,KAAlB,CAAwB,MAAM,IAA9B,CAAxB,CAAhB;AACAH,MAAAA,OAAO,CAACI,IAAR,CAAa,UAAmB;AAAA,YAAhBC,IAAgB,QAAhBA,IAAgB;;AAC9B,YAAI,CAACN,SAAL,EAAgB;AACd;AACAN,UAAAA,UAAU,CAAC,sBAASY,IAAT,IAAiBA,IAAjB,GAAwB,IAAzB,CAAV;AACAV,UAAAA,YAAY,CAAC,KAAD,CAAZ;AACD;AACF,OAND;AAQA,aAAO,MAAM;AACXI,QAAAA,SAAS,GAAG,IAAZ;AACAV,QAAAA,KAAK,CAACiB,OAAN,CAAcV,MAAd;AACD,OAHD;AAID,KAjBD,MAiBO;AACLH,MAAAA,UAAU,CAAC,IAAD,CAAV;AACAE,MAAAA,YAAY,CAAC,KAAD,CAAZ;AACD;AACF,GAxBD,EAwBG,CAACJ,OAAD,CAxBH;AA0BA,SAAO,CAACC,OAAD,EAAUE,SAAV,CAAP;AACD","sourcesContent":["import { isString, isObject, get } from \"lodash\";\r\nimport { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport { visualizationsSettings } from \"@/visualizations/visualizationsSettings\";\r\nimport createReferenceCountingCache from \"@/lib/referenceCountingCache\";\r\n\r\nconst cache = createReferenceCountingCache();\r\n\r\nexport default function useLoadGeoJson(mapType: any) {\r\n  const [geoJson, setGeoJson] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const mapUrl = get(visualizationsSettings, `choroplethAvailableMaps.${mapType}.url`, undefined);\r\n\r\n    if (isString(mapUrl)) {\r\n      setIsLoading(true);\r\n      let cancelled = false;\r\n\r\n      const promise = cache.get(mapUrl, () => axios.get(mapUrl).catch(() => null));\r\n      promise.then(({ data }: any) => {\r\n        if (!cancelled) {\r\n          // @ts-expect-error ts-migrate(2345) FIXME: Argument of type 'object | null' is not assignable... Remove this comment to see the full error message\r\n          setGeoJson(isObject(data) ? data : null);\r\n          setIsLoading(false);\r\n        }\r\n      });\r\n\r\n      return () => {\r\n        cancelled = true;\r\n        cache.release(mapUrl);\r\n      };\r\n    } else {\r\n      setGeoJson(null);\r\n      setIsLoading(false);\r\n    }\r\n  }, [mapType]);\r\n\r\n  return [geoJson, isLoading];\r\n}\r\n"],"file":"useLoadGeoJson.js"}