{"version":3,"sources":["../../../../src/visualizations/choropleth/Editor/BoundsSettings.tsx"],"names":["BoundsSettings","options","onOptionsChange","bounds","setBounds","onOptionsChangeDebounced","mapType","geoJson","defaultBounds","updateBounds","i","j","v","parseFloat","newBounds","boundsAvailable","undefined","value","propTypes","EditorPropTypes"],"mappings":"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","sourcesContent":["import { isArray, isFinite, cloneDeep } from \"lodash\";\r\nimport React, { useState, useEffect, useCallback } from \"react\";\r\nimport { useDebouncedCallback } from \"use-debounce\";\r\nimport * as Grid from \"antd/lib/grid\";\r\nimport { Section, InputNumber, ControlLabel } from \"@/components/visualizations/editor\";\r\nimport { EditorPropTypes } from \"@/visualizations/prop-types\";\r\n\r\nimport useLoadGeoJson from \"../hooks/useLoadGeoJson\";\r\nimport { getGeoJsonBounds } from \"./utils\";\r\n\r\nexport default function BoundsSettings({ options, onOptionsChange }: any) {\r\n  // Bounds may be changed in editor or on preview (by drag/zoom map).\r\n  // Changes from preview does not come frequently (only when user release mouse button),\r\n  // but changes from editor should be debounced.\r\n  // Therefore this component has intermediate state to hold immediate user input,\r\n  // which is updated from `options.bounds` and by inputs immediately on user input,\r\n  // but `onOptionsChange` event is debounced and uses last value from internal state.\r\n\r\n  const [bounds, setBounds] = useState(options.bounds);\r\n  const [onOptionsChangeDebounced] = useDebouncedCallback(onOptionsChange, 200);\r\n\r\n  const [geoJson] = useLoadGeoJson(options.mapType);\r\n\r\n  // `options.bounds` could be empty only if user didn't edit bounds yet - through preview or in this editor.\r\n  // In this case we should keep empty bounds value because it tells renderer to fit map every time.\r\n  useEffect(() => {\r\n    if (options.bounds) {\r\n      setBounds(options.bounds);\r\n    } else {\r\n      const defaultBounds = getGeoJsonBounds(geoJson);\r\n      if (defaultBounds) {\r\n        setBounds(defaultBounds);\r\n      }\r\n    }\r\n  }, [options.bounds, geoJson]);\r\n\r\n  const updateBounds = useCallback(\r\n    (i, j, v) => {\r\n      v = parseFloat(v); // InputNumber may emit `null` and empty strings instead of numbers\r\n      if (isFinite(v)) {\r\n        const newBounds = cloneDeep(bounds);\r\n        newBounds[i][j] = v;\r\n        setBounds(newBounds);\r\n        onOptionsChangeDebounced({ bounds: newBounds });\r\n      }\r\n    },\r\n    [bounds, onOptionsChangeDebounced]\r\n  );\r\n\r\n  const boundsAvailable = isArray(bounds);\r\n\r\n  return (\r\n    <React.Fragment>\r\n      {/* @ts-expect-error ts-migrate(2745) FIXME: This JSX tag's 'children' prop expects type 'never... Remove this comment to see the full error message */}\r\n      <Section>\r\n        {/* @ts-expect-error ts-migrate(2322) FIXME: Type 'string' is not assignable to type 'null | un... Remove this comment to see the full error message */}\r\n        <ControlLabel label=\"North-East Latitude and Longitude\">\r\n          {/* @ts-expect-error ts-migrate(2322) FIXME: Type 'Element' is not assignable to type 'null | u... Remove this comment to see the full error message */}\r\n          <Grid.Row gutter={15}>\r\n            <Grid.Col span={12}>\r\n              <InputNumber\r\n                disabled={!boundsAvailable}\r\n                value={boundsAvailable ? bounds[1][0] : undefined}\r\n                onChange={(value: any) => updateBounds(1, 0, value)}\r\n              />\r\n            </Grid.Col>\r\n            <Grid.Col span={12}>\r\n              <InputNumber\r\n                disabled={!boundsAvailable}\r\n                value={boundsAvailable ? bounds[1][1] : undefined}\r\n                onChange={(value: any) => updateBounds(1, 1, value)}\r\n              />\r\n            </Grid.Col>\r\n          </Grid.Row>\r\n        </ControlLabel>\r\n      </Section>\r\n\r\n      {/* @ts-expect-error ts-migrate(2745) FIXME: This JSX tag's 'children' prop expects type 'never... Remove this comment to see the full error message */}\r\n      <Section>\r\n        {/* @ts-expect-error ts-migrate(2322) FIXME: Type 'string' is not assignable to type 'null | un... Remove this comment to see the full error message */}\r\n        <ControlLabel label=\"South-West Latitude and Longitude\">\r\n          {/* @ts-expect-error ts-migrate(2322) FIXME: Type 'Element' is not assignable to type 'null | u... Remove this comment to see the full error message */}\r\n          <Grid.Row gutter={15}>\r\n            <Grid.Col span={12}>\r\n              <InputNumber\r\n                disabled={!boundsAvailable}\r\n                value={boundsAvailable ? bounds[0][0] : undefined}\r\n                onChange={(value: any) => updateBounds(0, 0, value)}\r\n              />\r\n            </Grid.Col>\r\n            <Grid.Col span={12}>\r\n              <InputNumber\r\n                disabled={!boundsAvailable}\r\n                value={boundsAvailable ? bounds[0][1] : undefined}\r\n                onChange={(value: any) => updateBounds(0, 1, value)}\r\n              />\r\n            </Grid.Col>\r\n          </Grid.Row>\r\n        </ControlLabel>\r\n      </Section>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\nBoundsSettings.propTypes = EditorPropTypes;\r\n"],"file":"BoundsSettings.js"}