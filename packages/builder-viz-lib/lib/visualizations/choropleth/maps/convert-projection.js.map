{"version":3,"sources":["../../../../src/visualizations/choropleth/maps/convert-projection.ts"],"names":["require","each","map","filter","d3","albersUSA","geo","albersUsa","mercator","geojson","convertPoint","coord","pt","invert","convertLineString","points","convertPolygon","polygon","convertMultiPolygon","multiPolygon","features","feature","geometry","type","coordinates","console","log","JSON","stringify"],"mappings":";;AAAA;AACA;eAE8BA,OAAO,CAAC,QAAD,C;IAA7BC,I,YAAAA,I;IAAMC,G,YAAAA,G;IAAKC,M,YAAAA,M,EACnB;;;AACA,IAAMC,EAAE,GAAGJ,OAAO,CAAC,IAAD,CAAlB,C,CAEA;;;AACA,IAAMK,SAAS,GAAGD,EAAE,CAACE,GAAH,CAAOC,SAAP,EAAlB,C,CACA;;AACA,IAAMC,QAAQ,GAAGJ,EAAE,CAACE,GAAH,CAAOE,QAAP,EAAjB;;AAEA,IAAMC,OAAO,GAAGT,OAAO,kBAAvB;;AAEA,SAASU,YAAT,CAAsBC,KAAtB,EAAkC;AAChC,MAAMC,EAAE,GAAGP,SAAS,CAACM,KAAD,CAApB;AACA,SAAOC,EAAE,GAAGJ,QAAQ,CAACK,MAAT,CAAgBD,EAAhB,CAAH,GAAyB,IAAlC;AACD;;AAED,SAASE,iBAAT,CAA2BC,MAA3B,EAAwC;AACtC,SAAOZ,MAAM,CAACD,GAAG,CAACa,MAAD,EAASL,YAAT,CAAJ,CAAb;AACD;;AAED,SAASM,cAAT,CAAwBC,OAAxB,EAAsC;AACpC,SAAOf,GAAG,CAACe,OAAD,EAAUH,iBAAV,CAAV;AACD;;AAED,SAASI,mBAAT,CAA6BC,YAA7B,EAAgD;AAC9C,SAAOjB,GAAG,CAACiB,YAAD,EAAeH,cAAf,CAAV;AACD;;AAEDf,IAAI,CAACQ,OAAO,CAACW,QAAT,EAAoBC,OAAD,IAAkB;AACvC,UAAQA,OAAO,CAACC,QAAR,CAAiBC,IAAzB;AACE,SAAK,SAAL;AACEF,MAAAA,OAAO,CAACC,QAAR,CAAiBE,WAAjB,GAA+BR,cAAc,CAACK,OAAO,CAACC,QAAR,CAAiBE,WAAlB,CAA7C;AACA;;AACF,SAAK,cAAL;AACEH,MAAAA,OAAO,CAACC,QAAR,CAAiBE,WAAjB,GAA+BN,mBAAmB,CAACG,OAAO,CAACC,QAAR,CAAiBE,WAAlB,CAAlD;AACA;AANJ;AAQD,CATG,CAAJ;AAWAC,OAAO,CAACC,GAAR,CAAYC,IAAI,CAACC,SAAL,CAAenB,OAAf,CAAZ","sourcesContent":["// This helper converts USA map from Mercator projection to Albers (USA)\r\n// Usage: `node convert-projection.js > usa-albers.geo.json`\r\n\r\nconst { each, map, filter } = require(\"lodash\");\r\n// @ts-expect-error ts-migrate(2403) FIXME: Subsequent variable declarations must have the sam... Remove this comment to see the full error message\r\nconst d3 = require(\"d3\");\r\n\r\n// @ts-expect-error ts-migrate(2339) FIXME: Property 'geo' does not exist on type 'typeof impo... Remove this comment to see the full error message\r\nconst albersUSA = d3.geo.albersUsa();\r\n// @ts-expect-error ts-migrate(2339) FIXME: Property 'geo' does not exist on type 'typeof impo... Remove this comment to see the full error message\r\nconst mercator = d3.geo.mercator();\r\n\r\nconst geojson = require(\"./usa.geo.json\");\r\n\r\nfunction convertPoint(coord: any) {\r\n  const pt = albersUSA(coord);\r\n  return pt ? mercator.invert(pt) : null;\r\n}\r\n\r\nfunction convertLineString(points: any) {\r\n  return filter(map(points, convertPoint));\r\n}\r\n\r\nfunction convertPolygon(polygon: any) {\r\n  return map(polygon, convertLineString);\r\n}\r\n\r\nfunction convertMultiPolygon(multiPolygon: any) {\r\n  return map(multiPolygon, convertPolygon);\r\n}\r\n\r\neach(geojson.features, (feature: any) => {\r\n  switch (feature.geometry.type) {\r\n    case \"Polygon\":\r\n      feature.geometry.coordinates = convertPolygon(feature.geometry.coordinates);\r\n      break;\r\n    case \"MultiPolygon\":\r\n      feature.geometry.coordinates = convertMultiPolygon(feature.geometry.coordinates);\r\n      break;\r\n  }\r\n});\r\n\r\nconsole.log(JSON.stringify(geojson));\r\n"],"file":"convert-projection.js"}